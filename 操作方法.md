# 動作確認マニュアル

このマニュアルは、実装した機能の動作を確認するための手順を説明します。

---

## フェーズ1: `運営者`の認証システム

### ステップ1: 準備

まず、アプリケーションを起動するための準備をします。

1.  **ターミナルを開き、プロジェクトディレクトリに移動します。**
    ```bash
    cd /path/to/your/project/FastAPI_mongoDB_10
    ```

2.  **仮想環境を有効化します。**
    ```bash
    source venv/bin/activate
    ```
    *(ターミナルの行頭に `(venv)` と表示されます)*

3.  **データベース接続情報を環境変数に設定します。**
    *MongoDBがローカルPCで動いている場合*
    ```bash
    export MONGO_URL='mongodb://localhost:27017/'
    ```
    *(この設定はターミナルを閉じるまで有効です)*

### ステップ2: `運営者`アカウントの作成

次に、ログインするための`運営者`アカウントを1つ作成します。

1.  **以下のコマンドを実行します。**
    *`<email>` と `<password>` の部分は、ご自身で決めたメールアドレスとパスワードに置き換えてください。*
    ```bash
    python create_operator.py operator@example.com MySecretPass123
    ```

2.  **「運営者アカウント ... を作成しました。」** というメッセージが表示されれば成功です。

### ステップ3: アプリケーションの起動

準備ができたので、Webサーバーを起動します。

1.  **以下のコマンドを実行します。**
    ```bash
    uvicorn main:app --reload --host 0.0.0.0 --port 8000
    ```

2.  `Application startup complete.` というメッセージが表示されたら、サーバーは待機状態です。

### ステップ4: 動作確認（`運営者`認証）

ブラウザを使って、認証システムが正しく機能しているかを確認します。

1.  **保護機能の確認（ログイン前）:**
    ブラウザで管理者向けページ `http://localhost:8000/admin/search` にアクセスし、自動的にログインページに転送されることを確認します。

2.  **ログイン機能の確認:**
    ログインページで、ステップ2で作成した`運営者`の認証情報を入力し、`/admin/search` ページに正しくリダイレクトされることを確認します。

3.  **保護機能の確認（ログイン後）:**
    ログインした状態で、他の管理者向けページ（例: `/admin/dashboard`）にアクセスし、ログインページに飛ばされずに表示されることを確認します。

---

## フェーズ2: `撮影者`の管理機能

### ステップ5: 動作確認（`撮影者`管理）

`運営者`としてログインした状態で、`撮影者`を管理する機能が正しく動作するか確認します。

1.  **管理ページへのアクセス:**
    管理者ダッシュボード `http://localhost:8000/admin/dashboard` にアクセスし、新しく追加された「**撮影者アカウント管理**」ボタンをクリックします。

2.  **管理ページの表示確認:**
    「撮影者アカウント管理」というタイトルのページが表示され、「新しい撮影者を作成」フォームと、「撮影者一覧」テーブルが表示されていることを確認します。

3.  **`撮影者`の作成:**
    フォームにテスト用のメールアドレスとパスワード（8文字以上）を入力し、「作成」ボタンを押します。
    *   **期待される動作:** ページがリロードされることなく、下の「撮影者一覧」に今作成したアカウントが即座に追加されます。

4.  **`撮影者`の削除:**
    一覧に追加されたアカウントの行にある「削除」ボタンを押します。
    *   **期待される動作:** 確認ダイアログが表示され、「OK」を押すと、そのアカウントが一覧から削除されます。

---

## 補足: ログアウトについて

現在、明確な「ログアウト」ボタンは実装されていません。ログイン状態は、ブラウザのCookieに保存されたアクセストークンによって維持されています。

ログアウトをテストしたい場合は、お使いのブラウザの開発者ツールなどを開いて、`localhost`または`127.0.0.1`に紐づいているCookieを削除してください。Cookieを削除すると、再度管理者向けページにアクセスした際にログインページへ転送されるようになります。